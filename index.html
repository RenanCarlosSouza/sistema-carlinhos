<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organizador Financeiro</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>

    <div id="toast-container"></div>

    <header>
        <div class="header-content">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                <h1>Sistema Carlinhos</h1>
                <button id="btn-tema" onclick="alternarTema()" class="btn-tema">üåô</button>
            </div>

            <nav>
                <button class="nav-btn active" onclick="mostrarTela('dashboard')">Painel</button>
                <button class="nav-btn" onclick="mostrarTela('carteira')">Carteira üí∞</button>
                <button class="nav-btn" onclick="mostrarTela('meus-eventos')">Eventos</button>
                <button class="nav-btn" onclick="mostrarTela('gastos')">Gastos Evento</button>
                <button class="nav-btn" onclick="mostrarTela('analise-evento')">Relat√≥rio</button>
                <button class="nav-btn" onclick="mostrarTela('analise-mensal')">Mensal</button>
                <button class="nav-btn" onclick="mostrarTela('backup')">Backup</button>
            </nav>
        </div>
    </header>

    <main class="container">

        <section id="dashboard" class="tela ativa">
            <h2>Vis√£o Geral</h2>
            <div class="grid-cards">
                <div class="card">
                    <h3>üí∞ Saldo Atual (Geral)</h3>
                    <p id="dash-saldo" class="destaque-numero" style="color:var(--text-primary)">R$ 0,00</p>
                    <small>Dinheiro em caixa</small>
                </div>
                <div class="card">
                    <h3>üìà Receitas (Total)</h3>
                    <p id="dash-entradas" class="destaque-numero" style="color:var(--success)">R$ 0,00</p>
                </div>
                <div class="card">
                    <h3>üìâ Despesas (Total)</h3>
                    <p id="dash-saidas" class="destaque-numero" style="color:var(--danger)">R$ 0,00</p>
                    <small>Eventos + Fixos</small>
                </div>
            </div>
        </section>

        <section id="carteira" class="tela">
            <div class="analise-visual-container">

                <div class="grafico-box" style="border-top: 4px solid var(--success);">
                    <h3>üìà Entradas / Receitas</h3>
                    <div class="box-card" style="margin-bottom:15px; border:none; box-shadow:none; padding:0;">
                        <div class="form-group"><input type="text" id="desc-receita" class="input-padrao"
                                placeholder="Descri√ß√£o (ex: Sal√°rio)"></div>
                        <div class="row">
                            <div class="form-group"><input type="date" id="data-receita" class="input-padrao"></div>
                            <div class="form-group"><input type="text" id="valor-receita" class="input-padrao"
                                    placeholder="R$ 0,00" oninput="mascaraMoeda(this)"></div>
                        </div>
                        <button class="btn-primary" style="background-color:var(--success)"
                            onclick="adicionarReceita()">+ Adicionar Entrada</button>
                    </div>
                    <ul id="lista-receitas" class="lista-customizada"></ul>
                </div>

                <div class="ranking-box" style="border-top: 4px solid var(--warning);">
                    <h3>üîÑ Contas Fixas (Todo M√™s)</h3>
                    <p style="font-size:0.8rem; margin-bottom:10px;">Estes valores ser√£o descontados automaticamente
                        todos os meses.</p>
                    <div class="box-card" style="margin-bottom:15px; border:none; box-shadow:none; padding:0;">
                        <div class="form-group"><input type="text" id="desc-fixo" class="input-padrao"
                                placeholder="Descri√ß√£o (ex: Netflix)"></div>
                        <div class="row">
                            <div class="form-group">
                                <select id="cat-fixo" class="input-padrao">
                                    <option value="Assinatura">üì∫ Assinatura</option>
                                    <option value="Casa">üè† Casa/Aluguel</option>
                                    <option value="Internet">üåê Internet/Celular</option>
                                    <option value="Servico">üí° Luz/√Ågua</option>
                                    <option value="Educacao">üéì Educa√ß√£o</option>
                                    <option value="Outros">üìù Outros</option>
                                </select>
                            </div>
                            <div class="form-group"><input type="text" id="valor-fixo" class="input-padrao"
                                    placeholder="R$ 0,00" oninput="mascaraMoeda(this)"></div>
                        </div>
                        <button class="btn-primary" style="background-color:var(--warning); color:#000;"
                            onclick="adicionarFixo()">+ Criar Gasto Fixo</button>
                    </div>
                    <ul id="lista-fixos" class="lista-customizada"></ul>
                </div>

            </div>
        </section>

        <section id="meus-eventos" class="tela">
            <div class="topo-acao no-print">
                <h2>Meus Eventos</h2>
                <button class="btn-primary" onclick="prepararNovoEvento()">+ Novo Evento</button>
            </div>
            <input type="text" id="busca-evento" class="input-padrao" placeholder="üîç Buscar evento..."
                onkeyup="filtrarEventos()">

            <div class="grupo-evento">
                <h3 class="status-pendente">‚è≥ Em Andamento</h3>
                <div class="tabela-container">
                    <table id="tabela-pendentes">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Prazo</th>
                                <th>Progresso</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="grupo-evento">
                <h3 class="status-concluido">‚úÖ Conclu√≠dos</h3>
                <div class="tabela-container">
                    <table id="tabela-concluidos">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Data</th>
                                <th>Or√ßamento</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="grupo-evento">
                <h3 class="status-cancelado">‚ùå Cancelados</h3>
                <div class="tabela-container">
                    <table id="tabela-cancelados">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="gastos" class="tela">
            <h2>Lan√ßar Gastos (Evento)</h2>
            <div class="form-group"><label>Selecione o Evento:</label><select id="select-evento-gastos"
                    onchange="carregarGastosDoEvento()" class="input-padrao"></select></div>
            <div id="area-gastos" style="display:none;">
                <div class="box-card">
                    <h3>Novo Gasto</h3>
                    <div class="row">
                        <div class="form-group" style="flex:2;"><label>Descri√ß√£o</label><input type="text"
                                id="desc-gasto" class="input-padrao" placeholder="Ex: Uber"></div>
                        <div class="form-group" style="flex:1;"><label>Categoria</label><select id="cat-gasto"
                                class="input-padrao">
                                <option value="Alimentacao">üçî Alimenta√ß√£o</option>
                                <option value="Bebidas">üçª Bebidas</option>
                                <option value="Entretenimento">üéüÔ∏è Entretenimento</option>
                                <option value="Transporte">üöó Transporte</option>
                                <option value="Mercado">üõí Mercado</option>
                                <option value="Lazer">üèñÔ∏è Lazer</option>
                                <option value="Presentes">üéÅ Presentes</option>
                                <option value="Outros">üìù Outros</option>
                            </select></div>
                    </div>
                    <div class="row">
                        <div class="form-group" style="flex:1;"><label>Pagamento</label><select id="pagto-gasto"
                                class="input-padrao">
                                <option value="Credito">üí≥ Cr√©dito</option>
                                <option value="Debito">üí≥ D√©bito</option>
                                <option value="Pix">üí† Pix</option>
                                <option value="Dinheiro">üíµ Dinheiro</option>
                            </select></div>
                        <div class="form-group" style="flex:1;"><label>Valor</label><input type="text" id="valor-gasto"
                                class="input-padrao" placeholder="R$ 0,00" oninput="mascaraMoeda(this)"></div>
                    </div>
                    <button class="btn-primary" onclick="adicionarGasto()">Adicionar</button>
                </div>
                <ul id="lista-gastos" class="lista-customizada"></ul>
            </div>
        </section>

        <section id="analise-evento" class="tela">
            <div class="topo-acao no-print">
                <h2>Relat√≥rio Visual</h2><button class="btn-secondary" onclick="imprimirRelatorio()">üñ®Ô∏è
                    Imprimir</button>
            </div>
            <div class="form-group no-print"><label>Evento:</label><select id="select-evento-analise"
                    onchange="carregarAnaliseDoEvento()" class="input-padrao"></select></div>
            <div id="conteudo-analise" style="display: none;">
                <div class="cabecalho-print">
                    <h1>Relat√≥rio</h1>
                    <h2 id="print-nome-evento">---</h2>
                </div>
                <div class="grid-cards">
                    <div class="card">
                        <h3>Or√ßamento</h3>
                        <p id="analise-orcamento" class="destaque-numero">R$ 0</p>
                    </div>
                    <div class="card">
                        <h3>Gasto</h3>
                        <p id="analise-gasto" class="destaque-numero">R$ 0</p>
                    </div>
                    <div class="card">
                        <h3>Saldo</h3>
                        <p id="analise-saldo" class="destaque-numero">R$ 0</p>
                    </div>
                </div>
                <div class="analise-visual-container">
                    <div class="grafico-box">
                        <h3>Distribui√ß√£o</h3>
                        <div class="chart-container"><canvas id="meuGrafico"></canvas></div>
                    </div>
                    <div class="ranking-box">
                        <h3>üèÜ Top Gastos</h3>
                        <ul id="lista-ranking" class="lista-customizada"></ul>
                        <h3 style="margin-top:15px;">üí≥ Pagamentos</h3>
                        <ul id="lista-pagamentos" class="lista-customizada"></ul>
                    </div>
                </div>
                <div style="margin-top:20px;">
                    <h3>Meta do Evento</h3>
                    <div class="barra-fundo">
                        <div id="analise-barra-progresso" class="barra-cheia" style="width:0%"></div>
                    </div>
                    <p id="analise-barra-texto" style="text-align:right">0%</p>
                </div>
                <div class="somente-print">
                    <h3>Detalhamento</h3>
                    <ul id="lista-print-gastos" class="lista-customizada"></ul>
                </div>
            </div>
        </section>

        <section id="analise-mensal" class="tela">
            <div class="topo-acao no-print">
                <h2>Fechamento Mensal</h2><button class="btn-secondary" onclick="imprimirRelatorio()">üñ®Ô∏è
                    Imprimir</button>
            </div>
            <div class="cabecalho-print">
                <h1>Mensal</h1>
                <h2 id="print-mes-referencia">---</h2>
            </div>
            <div class="box-card no-print">
                <div class="row">
                    <div class="form-group"><label>M√™s</label><input type="month" id="mes-referencia"
                            class="input-padrao" onchange="calcularAnaliseMensal()"></div>
                    <div class="form-group"><label>Meta Mensal</label><input type="text" id="meta-mensal"
                            class="input-padrao" placeholder="R$ 0,00" oninput="mascaraMoeda(this)"
                            onchange="salvarEMudarMeta()"></div>
                </div>
            </div>

            <div id="resultado-mensal" style="display:none;">
                <div class="grid-cards" style="margin-bottom:20px;">
                    <div class="card">
                        <h3>(+) Entradas</h3>
                        <p id="mensal-entradas" class="destaque-numero" style="color:var(--success)">R$ 0</p>
                    </div>
                    <div class="card">
                        <h3>(-) Fixos + Eventos</h3>
                        <p id="mensal-saidas" class="destaque-numero" style="color:var(--danger)">R$ 0</p>
                    </div>
                    <div class="card">
                        <h3>(=) Saldo do M√™s</h3>
                        <p id="mensal-saldo" class="destaque-numero">R$ 0</p>
                    </div>
                </div>

                <div id="semaforo-box" class="semaforo-neutro" style="margin-bottom:20px;">
                    <h3 id="semaforo-titulo">---</h3>
                    <p id="semaforo-msg">---</p>
                </div>
                <div style="margin-bottom:20px;">
                    <h3>Consumo da Meta</h3>
                    <div class="barra-fundo">
                        <div id="mensal-barra-progresso" class="barra-cheia" style="width:0%"></div>
                    </div>
                    <p id="mensal-barra-texto" style="text-align:right">0%</p>
                </div>

                <div class="analise-visual-container">
                    <div class="grafico-box">
                        <h3>Onde foi o dinheiro?</h3>
                        <div class="chart-container"><canvas id="graficoMensal"></canvas></div>
                    </div>
                    <div class="ranking-box">
                        <h3>üìã Detalhe dos Gastos</h3>
                        <p><strong>Gastos Fixos:</strong></p>
                        <ul id="lista-fixos-mensal" class="lista-customizada" style="margin-bottom:15px;"></ul>
                        <p><strong>Top Eventos:</strong></p>
                        <ul id="lista-top-eventos" class="lista-customizada"></ul>
                    </div>
                </div>
            </div>
        </section>

        <section id="backup" class="tela">
            <h2>Backup</h2>
            <div class="grid-cards">
                <div class="card">
                    <h3>üì• Baixar Dados</h3><button class="btn-primary" onclick="exportarDados()">Download JSON</button>
                </div>
                <div class="card" style="border-color:var(--danger)">
                    <h3>üì§ Restaurar</h3><input type="file" id="arquivo-backup" accept=".json"
                        style="margin-top:10px;"><button class="btn-danger" onclick="importarDados()"
                        style="margin-top:10px;">Restaurar</button>
                </div>
            </div>
        </section>

        <section id="form-evento-tela" class="tela">
            <h2>Novo Evento</h2>
            <form id="form-evento" class="box-card">
                <input type="hidden" id="evento-id">
                <div class="form-group"><label>Nome</label><input type="text" id="nome-evento" class="input-padrao">
                </div>
                <div class="row">
                    <div class="form-group"><label>Data</label><input type="date" id="data-evento" class="input-padrao">
                    </div>
                    <div class="form-group"><label>Local</label><input type="text" id="local-evento"
                            class="input-padrao"></div>
                </div>
                <div class="row">
                    <div class="form-group"><label>Status</label><select id="status-evento" class="input-padrao">
                            <option value="Pendente">Pendente</option>
                            <option value="Concluido">Conclu√≠do</option>
                            <option value="Cancelado">Cancelado</option>
                        </select></div>
                    <div class="form-group"><label>Or√ßamento</label><input type="text" id="orcamento-previsto"
                            class="input-padrao" placeholder="R$ 0,00" oninput="mascaraMoeda(this)"></div>
                </div>
                <div class="row" style="margin-top:20px;">
                    <button type="button" class="btn-secondary" onclick="mostrarTela('meus-eventos')"
                        style="flex:1; margin-right:10px;">Cancelar</button>
                    <button type="button" class="btn-primary" onclick="salvarEvento()" style="flex:1;">Salvar</button>
                </div>
            </form>
        </section>
    </main>
    <script src="script.js"></script>
</body>

</html>
